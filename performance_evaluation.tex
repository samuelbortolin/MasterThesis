\chapter{Performance Evaluation}
\label{cha:evaluation}
\vspace{0.4 cm}

In this chapter, the proposed system is validated and the performance of the models for the different use cases is evaluated.
The first section presents the datasets provided by MIWEnergia\footnote{ \url{https://www.miwenergia.com/} }.
Subsequently, the adapted evaluation methodology is described.
Finally, the evaluation of the performance of the models for the different use cases is presented.
After this chapter, it will be clear how the system has been validated and what the performance achieved by the proposed system is.


\section{MIWEnergia datasets}
\label{sec:datasets}
\vspace{0.2 cm}

In this section, the MIWEnergia datasets are described.
They provided 3 kinds of datasets: aggregated consumption data from all their customers, consumption data from 4 customers, and production data from 8 PV plants.

The aggregated consumption data from all their customers, whose number is variable (with a maximum of 4253, a minimum of 1591, a mean of 3235 (2988), and a standard deviation of 779 (855)) consists of hourly aggregated consumption data from June 2021 to September 2022 (January 2023) for a total of 11687 (14617) total entries.
The graphical representation of the hourly aggregated consumption data is reported in figure~\ref{fig:demanddataplot} (figure~\ref{fig:demanddataplot2}).

\begin{figure}[H]
\begin{minipage}[b]{8.5cm}
\centering
\includegraphics[width=1\textwidth]{images/demand/data_plot}
\subcaption{}
\label{fig:demanddataplot}
\end{minipage}
\ \hspace{2mm} \
%  Consifer the latest data? --> relaunch trainings + fine-tuning
\begin{minipage}[b]{8.5cm}
\centering
\includegraphics[width=1\textwidth]{images/demand/data_plot_2}
\subcaption{}
\label{fig:demanddataplot2}
\end{minipage}
\caption{The graphical representation of the hourly aggregated consumption data.}
\end{figure}

%  \begin{figure}[H]
%  \centering
%  \includegraphics[width=0.55\textwidth]{images/demand/data_plot}
%  \caption{The graphical representation of the hourly aggregated consumption data.}
%  \label{fig:demanddataplot}
%  \end{figure}

The consumption data from 4 customers consists of hourly aggregated consumption data:
\begin{enumerate}
  \item from June 2021 to May 2022 for a total of 8750 total entries (represented in figure~\ref{fig:dataplotcustomer1});
  \item from September 2021 to May 2022 for a total of 5855 total entries (represented in figure~\ref{fig:dataplotcustomer2});
  \item from September 2021 to August 2022 for a total of 8745 total entries (represented in figure~\ref{fig:dataplotcustomer3});
  \item from September 2021 to August 2022 for a total of 8760 total entries (represented in figure~\ref{fig:dataplotcustomer4}).
\end{enumerate}
The total entries for the 4 customers are 32110 in the overall period from June 2021 to August 2022.

\begin{figure}[H]
\begin{minipage}[b]{8.5cm}
\centering
\includegraphics[width=1\textwidth]{images/baseline/data_plot_customer1}
\subcaption{First customer.}
\label{fig:dataplotcustomer1}
\end{minipage}
\ \hspace{2mm} \
\begin{minipage}[b]{8.5cm}
\centering
\includegraphics[width=1\textwidth]{images/baseline/data_plot_customer2}
\subcaption{Second customer.}
\label{fig:dataplotcustomer2}
\end{minipage}
\begin{minipage}[b]{8.5cm}
\centering
\includegraphics[width=1\textwidth]{images/baseline/data_plot_customer3}
\subcaption{Third customer.}
\label{fig:dataplotcustomer3}
\end{minipage}
\ \hspace{2mm} \
\begin{minipage}[b]{8.5cm}
\centering
\includegraphics[width=1\textwidth]{images/baseline/data_plot_customer4}
\subcaption{Fourth customer.}
\label{fig:dataplotcustomer4}
\end{minipage}
\caption{The graphical representation of the consumption data of the 4 customers.}
\end{figure}

The production data from 8 PV plants consists of hourly aggregated production data:
\begin{enumerate}
  \item from January 2022 to October 2022 for a total of 7296 total entries;
  \item from February 2022 to October 2022 for a total of 6552 total entries;
  \item from February 2022 to October 2022 for a total of 6552 total entries;
  \item from June 2022 to October 2022 for a total of 3576 total entries;
  \item from September 2022 to October 2022 for a total of 1465 total entries;
  \item from September 2022 to October 2022 for a total of 1465 total entries;
  \item from September 2022 to October 2022 for a total of 1465 total entries;
  \item from September 2022 to October 2022 for a total of 1465 total entries.
\end{enumerate}
The total entries for the 8 PV plants are 29836 total entries in the overall period from January 2022 to October 2022.
The graphical representation of the hourly aggregated total and mean percentage production data are reported respectively in figure~\ref{fig:productiondataplot} and figure~\ref{fig:productiondataplotpercentage}.

\begin{figure}[H]
\begin{minipage}[b]{8.5cm}
\centering
\includegraphics[width=1\textwidth]{images/production/data_plot}
\subcaption{}
\label{fig:productiondataplot}
\end{minipage}
\ \hspace{2mm} \
\begin{minipage}[b]{8.5cm}
\centering
\includegraphics[width=1\textwidth]{images/production/data_plot_percentage}
\subcaption{}
\label{fig:productiondataplotpercentage}
\end{minipage}
\caption{The graphical representation of the hourly aggregated \subref{fig:umlsingleplant} total and \subref{fig:umlsingleplant} mean percentage production data.}
\end{figure}


\section{Evaluation methodology}
\label{sec:methodology}
\vspace{0.2 cm}

The evaluation methodology was based on two relevant error metrics:
\begin{itemize}
  \item Mean Absolute Percentage Error (MAPE) is defined as $\text{MAE}(y, \hat{y}) = \frac{ \sum_{i=0}^{N - 1} |y_i - \hat{y}_i| }{N}$. It is the most relevant error metric for all the tasks.
  \item Mean Absolute Error (MAE) is defined as $\text{MAPE}(y, \hat{y}) = \frac{100\%}{N} \sum_{i=0}^{N - 1} \frac{|y_i - \hat{y}_i|}{|y_i|}$. It is the most applicable error metric in consumption baseline forecasting where there is a high variability, and electricity production forecasting where there are a lot of zeros when the sun is not present.
\end{itemize}

Describe how the test of the performance of the models works ...

Treat the validation: describe the blocked k-fold validation and the hold-out approach repeated in multiple periods ...


\section{Electricity demand forecasting}
\label{sec:demandval}
\vspace{0.2 cm}

Analyze the data (descriptive analytics) and the results of the models for the electricity demand forecasting task (predictive analytics) ...

It was thought to normalize the consumption on the number of customers for studying a kind of mean consumption per user and then multiplying by the number of users, but this was not possible since often this value has a high change without reflecting on the consumption data, this information was not used since classified as unreliable.

Data stats and correlation with weather data ...

Basic data is enhanced with the air temperature, the apparent temperature, and the relative humidity.

Describe the choice of parameters for models ... (list with motivations)

Summary table with results ...


\section{Consumption baseline forecasting}
\label{sec:baselineval}
\vspace{0.2 cm}

Analyze the data (descriptive analytics) and the results of the models for the consumption baseline forecasting task (predictive analytics) ...

Data stats and correlation with weather data ...

As can be noticed from the data, there is high variability in consumption and low auto-correlation, this suggests how it is difficult to produce highly accurate results.

Basic data is enhanced with the air temperature, the apparent temperature, and the relative humidity.

Describe the choice of parameters for models ... (list with motivations)

Summary table with results ...


\section{Electricity production forecasting}
\label{sec:productionval}
\vspace{0.2 cm}

Analyze the data (descriptive analytics) and the results of the models for the electricity production forecasting task (predictive analytics) ...

As described in the data preprocessing in chapter~\ref{cha:implementation}, single PV plant production data are aggregated to obtain the aggregated production data over the PV plants.
The target of the predictions is the mean percentage of production, which is calculated as the division of the total produced energy by the total power of the PV plants.
This allows to have a bounded value from 0 to 100 from which it is possible to obtain the total produced energy simply by multiplying it by the total power of the PV plants.
(This was also done since plants are added over time and this was unpredictable, this results in predicting the percentage of production of the PV plants.)

Data stats and correlation with weather data ...

Basic data is enhanced with the air temperature, the apparent temperature, the relative humidity, the wind speed, the wind direction, the pressure altimeter, the visibility, the sky coverage, the diffuse horizontal irradiance, the direct normal irradiance, the global horizontal irradiance, the solar radiation, the UV index, the solar elevation angle, and the solar azimuth angle.
Only the hourly granularity is considered since PV plants are highly correlated with weather data and the aggregation over the day loses this correlation.

Describe the choice of parameters for models ... (list with motivations)

Summary table with results ...
